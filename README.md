# Catapult

Catapult is an automated tool for running Mass Spectrometry Search on files generated by the instrument. It is used to watch for new files and process them as they are created according to specified experimental parameters.

## Installation

### Windows

Docker and Python 3.10 is required for simple deployment on windows.

1. Install Docker Desktop from [Docker Hub](https://hub.docker.com/editions/community/docker-ce-desktop-windows)
2. Install Python 3.10 from [Python.org](https://www.python.org/downloads/release/python-3100/)
3. Download the repository to your local machine
4. Open a terminal and navigate to the repository
5. Run `pip install -r requirements.txt` to install the required python packages
6. Run `docker-compose up -d` to start the application
7. Open a web browser and navigate to `http://localhost/admin` to access the application
8. Create a superuser account by running `docker-compose exec -it catapult python manage.py createsuperuser` and following the prompts
9. Log in to the application using the superuser account

### Linux

To be added

## Operation

Modify the `settings.py` file in the `catapult_backend` directory at the DIANN_PATH and replace `r"C:\DIA-NN\1.8.1\DiaNN.exe"` with your `DiaNN.exe` executable path

or in your terminal or environment variable editor, set the following environment variables:
- DIANN_PATH: The path to the `DiaNN.exe` executable

### To setup a folder to be watched

In the terminal, run `python manage.py watch_folder <folder_path> <whether_the_location_is_networked> <file_extensions_delimited_by_commas>`

### To setup a process to check for files that are ready to be processed and dispatch the job for processing them

In the terminal, run `python manage.py database_check <check_interval_in_seconds> <time_delta_since_last_file_size_change>`

### To setup a work queue to process the dispatched jobs

In the terminal, run `celery -A catapult_backend worker --loglevel=INFO -P solo`


